<ng-template #statExplanation let-text="text">
  <div class="p-2">
    <span class="text-white bg-black">{{ text }}</span>
  </div>
</ng-template>
<div class="table-responsive rarity-table">
  <table class="table table-dark" [ngClass]="{ 'table-striped': !simplified }">
    <tbody [ngClass]="{ 'simplified-table-body row': simplified }">
      <tr *ngIf="!simplified">
        <td colspan="3" class="table-section">Rarity Stats</td>
      </tr>
      <tr
        [ngClass]="{ 'col-6': simplified }"
        *ngFor="let perStat of perStatItems"
      >
        <td class="flex justify-content-start">
          <div class="stat-icon" [ngClass]="getStatIconClass(perStat.key)">
            <img
              class="stat-icon-img"
              src="{{ prefix + perStat.icon }}"
              alt=""
            />
          </div>
        </td>
        <td class="w-100">
          <span
            class="stat-value"
            [ngClass]="getValueStatusClass(player.perStats[perStat.key])"
          >
            {{ (player.perStats[perStat.key] || 0) | number: '1.0-2' }}%
            <span
              *ngIf="
                !!hoveredItemStats &&
                !!hoveredItemStats[mapTotalPercentLabels[perStat.key]]
              "
              class="stat-value"
              [ngClass]="
                getValueStatusClass(
                  hoveredItemStats[mapTotalPercentLabels[perStat.key]]
                )
              "
            >
              {{
                hoveredItemStats[mapTotalPercentLabels[perStat.key]] +
                  getPercentage(perStat.key)
              }}</span
            >
          </span>
          <i
            class="fa-solid fa-circle-info text-third fa-sm px-1"
            [ngbTooltip]="statExplanation"
            [tooltipContext]="{ text: perStat.tooltip }"
          ></i>
        </td>
        <td *ngIf="!simplified">
          <span *ngIf="cappedPerStats[perStat.key]" class="max-value">
            (Max: {{ cappedPerStats[perStat.key] }}%)
          </span>
        </td>
      </tr>
    </tbody>
  </table>
</div>
